// Reference data for permuto encoder tests
// Generated by: cd tiny-cuda-nn/build && ./permuto_jit_test f b

// ============================================================================
// Forward pass verification data
// ============================================================================

// Position verification indices (same for forward and backward)
public static const uint NUM_VERIFY_POSITIONS = 16;
public static const uint VERIFY_POSITIONS[NUM_VERIFY_POSITIONS] = {
    0, 5, 17, 42, 63, 100, 128, 150,
    180, 199, 210, 230, 240, 250, 253, 255
};

// Expected forward pass output values: [NUM_VERIFY_POSITIONS * N_FEATURES] = [128]
// Layout: [pos0_level0_f0, pos0_level0_f1, ..., pos0_level3_f1, pos1_level0_f0, ...]
public static const uint N_FEATURES_FOR_VERIFY = 8;  // N_LEVELS * FEATURE_DIM_PER_ENTRY
public static const float EXPECTED_FORWARD_VALUES[NUM_VERIFY_POSITIONS * N_FEATURES_FOR_VERIFY] = {
    // pos=0
    273.577118f, 274.577148f, 614.023804f, 615.023804f, 1117.943237f, 1118.943237f, 1754.296875f, 1755.296875f,
    // pos=5
    171.046661f, 172.046661f, 750.690491f, 751.690430f, 1504.494873f, 1505.494873f, 1715.986938f, 1716.986816f,
    // pos=17
    216.328766f, 217.328751f, 685.235718f, 686.235657f, 1319.360962f, 1320.360962f, 1704.348511f, 1705.348511f,
    // pos=42
    35.614384f, 36.614384f, 643.529175f, 644.529175f, 1189.797974f, 1190.797974f, 1975.376099f, 1976.376221f,
    // pos=63
    99.446777f, 100.446777f, 643.659668f, 644.659729f, 1113.920776f, 1114.920776f, 1883.739502f, 1884.739380f,
    // pos=100
    39.685390f, 40.685390f, 986.628906f, 987.628967f, 1147.829468f, 1148.829468f, 1565.992920f, 1566.992920f,
    // pos=128
    32.057064f, 33.057068f, 965.052917f, 966.052917f, 1086.802979f, 1087.802979f, 1894.884521f, 1895.884521f,
    // pos=150
    105.553284f, 106.553284f, 660.931458f, 661.931458f, 1162.772461f, 1163.772461f, 1727.836426f, 1728.836426f,
    // pos=180
    117.252563f, 118.252563f, 694.021973f, 695.021973f, 1256.366821f, 1257.366821f, 1774.636475f, 1775.636475f,
    // pos=199
    161.757385f, 162.757385f, 819.900513f, 820.900513f, 1302.556396f, 1303.556396f, 1757.666504f, 1758.666504f,
    // pos=210
    128.951828f, 129.951828f, 727.112610f, 728.112610f, 1349.960938f, 1350.961060f, 1794.304199f, 1795.304199f,
    // pos=230
    183.120438f, 184.120438f, 880.324524f, 881.324524f, 1271.310059f, 1272.309937f, 1729.058105f, 1730.057983f,
    // pos=240
    140.651123f, 141.651123f, 760.203247f, 761.203186f, 1443.555420f, 1444.555542f, 1792.086548f, 1793.086670f,
    // pos=250
    237.289078f, 238.289078f, 828.529419f, 829.529419f, 1192.658936f, 1193.658936f, 1930.753052f, 1931.753174f,
    // pos=253
    266.280457f, 267.280426f, 654.529358f, 655.529358f, 1424.589844f, 1425.589966f, 1683.534424f, 1684.534424f,
    // pos=255
    285.608032f, 286.608032f, 658.203247f, 659.203247f, 1156.350098f, 1157.349976f, 1779.534546f, 1780.534546f
};

// ============================================================================
// Backward pass verification data
// ============================================================================

// Expected dL/dpos values: [NUM_VERIFY_POSITIONS * N_POS_DIMS] = [32]
// These are the position gradients when dL_dy = all ones
public static const uint N_POS_DIMS_FOR_VERIFY = 2;
public static const float EXPECTED_DL_DPOS[NUM_VERIFY_POSITIONS * N_POS_DIMS_FOR_VERIFY] = {
    // pos=0
    -12155.595703f, -22404.500000f,
    // pos=5
    9689.738281f, 15432.727539f,
    // pos=17
    9689.735352f, 15432.728516f,
    // pos=42
    201.013672f, -1002.227539f,
    // pos=63
    10655.171875f, 17104.906250f,
    // pos=100
    -11190.160156f, -20732.316406f,
    // pos=128
    10655.173828f, 17104.914062f,
    // pos=150
    -11190.161133f, -20732.316406f,
    // pos=180
    10655.171875f, 17104.906250f,
    // pos=199
    2931.680664f, 3727.434570f,
    // pos=210
    -11190.159180f, -20732.314453f,
    // pos=230
    10655.174805f, 17104.914062f,
    // pos=240
    10655.167969f, 17104.910156f,
    // pos=250
    7924.505371f, 12375.252930f,
    // pos=253
    -13920.826172f, -25461.970703f,
    // pos=255
    -18913.652344f, -34109.796875f
};

// Feature table gradient verification
public static const uint NUM_VERIFY_PARAMS = 64;
public static const uint VERIFY_PARAM_INDICES[NUM_VERIFY_PARAMS] = {
    14, 15, 20, 21, 26, 27, 32, 33, 166, 167, 172, 173, 178, 179, 184, 185,
    324, 325, 330, 331, 336, 337, 374, 375, 380, 381, 516, 517, 522, 523, 528, 529,
    548, 549, 554, 555, 612, 613, 618, 619, 624, 625, 644, 645, 650, 651, 656, 657,
    662, 663, 668, 669, 674, 675, 680, 681, 700, 701, 706, 707, 712, 713, 718, 719
};

public static const float EXPECTED_DL_DPARAMS[NUM_VERIFY_PARAMS] = {
    16.967556f, 16.967556f, 70.231255f, 70.231255f, 27.992424f, 27.992424f, 0.013881f, 0.013881f,
    2.832253f, 2.832253f, 51.313324f, 51.313324f, 57.329113f, 57.329113f, 2.362840f, 2.362840f,
    0.210447f, 0.210447f, 11.309252f, 11.309256f, 1.614394f, 1.614394f, 8.073534f, 8.073533f,
    5.749718f, 5.749718f, 10.441026f, 10.441026f, 10.125997f, 10.125997f, 2.896510f, 2.896510f,
    0.460675f, 0.460675f, 1.392687f, 1.392687f, 0.709921f, 0.709921f, 5.098586f, 5.098586f,
    4.271206f, 4.271206f, 0.750983f, 0.750983f, 8.397438f, 8.397438f, 10.428171f, 10.428171f,
    10.441025f, 10.441025f, 10.343852f, 10.343852f, 10.359573f, 10.359573f, 4.673015f, 4.673015f,
    0.796428f, 0.796428f, 8.192450f, 8.192450f, 6.516029f, 6.516029f, 1.643831f, 1.643831f
};
